## События jQuery

Классический вид обработчиков событий следующий:

```
$("Селектор").методСобытия(ФункцияОбработчикСобытия);
```

На практике часто используется универсальный метод для __.on()__

Общий вид синтаксиса метода __.on()__

```
$("Селектор").on("ИмяСобытия", ОбъектДанных, ФункцияОбработчикСобытия);
```

### События в элементах DOM

__Рассмотрим часто используемые события jQuery для элементов разметки

__Список событий по категориям:__

https://basicweb.ru/jquery/jquery_events.php

__События мыши:__

```javascript
////////////////////////////////////////////////////////////
// Событие "click"
////////////////////////////////////////////////////////////

$(".myElement").click(function(){
  console.log("Клик по элементу");
});

////////////////////////////////////////////////////////////
// Событие "hover" - наведение мышью на элемент 
// ! Имеет два обработчика (для наведения и отведения) 
////////////////////////////////////////////////////////////

$(".myElement").hover(function(){
  console.log("Навели мышку на элемент");
}, function(){
  console.log("Убрали мышку с элемента");
);

////////////////////////////////////////////////////////////
// Передача ссылок на обработчики событий 
// (очень рекомендуется к использованию)
////////////////////////////////////////////////////////////

$(".myElement").hover(hoverIn, hoverOut);  

function hoverIn(){
  console.log("Навели мышку на элемент"); 
}

function hoverOut(){
  console.log("Убрали мышку с элемента"); 
}
```

__События элементов форм__

```javascript
////////////////////////////////////////////////////////////
// Событие "change" - для select, checbox, radio
////////////////////////////////////////////////////////////

$("select").change(function(){
  var selectValue = $(this).val();
  console.log(selectValue); 
}); 

////////////////////////////////////////////////////////////
// События focus, blue, focusIn, focusOut
////////////////////////////////////////////////////////////

// Курсор на текстовом поле 

$('input[type="text"]').focus(function(){
  var $input    = $(this);     // Кешируем! 
  var textInput = input.val(); // Текст элемента (если он там БЫЛ!) 
  $input.addClass("selected"); // Установим класс для выделения
}); 

// Курсор убрали 

$('input[type="text"]').blur(function(){
  console.log("Убрали курсор с элемента"); 
}); 
```

События __focusIn__, __focusOut__ аналогичны событиям __focus__ и __blur__, и отличаются от них только тем, что поддерживают всплытие событий (event bubbling). 

__Отправка форм: событие submit()__ 

Рассмотрим использования обработчика события __submit__ для форм, использующих перезагрузку страницы (не AJAX формы) 

``` 
////////////////////////////////////////////////////////////
// Событие "submit" - отправка формы 
////////////////////////////////////////////////////////////

// ! Данный метод не будет работать для форм, работающих с перезагрузкой страницы 
$("form").submit(function(){ 
  alert("Вы отправляете форму!"); 
});

// Для форм, работающих перезагрузкой можно использовать 
// следующие варианты перехватчиков событий

////////////////////////////////////////////////////////////
// 1) Простой вариант с кнопкой формы (отложенная блокировка) 
////////////////////////////////////////////////////////////

// Заблокировать отправку формы 
// (так можно запретить с перезагрузкой отправку любой форме!) 

<form submit="return false">

// Повесить обработчик на КНОПКЕ формы 
$("form button").click(function(){
  var $form = $(this).parents("form"); // Кешируем форму 
  
  // Выполнение полезной нагрузки 
  console.log("МЫ ПОЙМАЛИ МОМЕНТ ОТПРАВКИ ФОРМЫ! УРА!");    
  
  // Отправим форму через секунду 		  
  setTimeout(function(){
    	$form.attr("onSubmit", "return true");  // Изменим атрибут формы 
    $form.submit(); // Отправляем форму 
  }, 1000); 
});

////////////////////////////////////////////////////////////
// 2) Продвинутый вариант (меньше кода, больше дела!) 
////////////////////////////////////////////////////////////

$("form").submit(function(event){
  event.preventDefault(); // Блокируем перезагрузку страницы 
  var $form = $(this);    // Кешируем форму 
    		
  console.log("Наш полезный код!"); 
  
  // Отправим форму через 1 секунду (вместо этого, можно сделать полезный ajax запрос)
  setTimeout(function(){
    	$form.unbind('submit').submit(); // Отключаем текущий обработчик и отправляем форму
  }, 1000);
});

```

Для форм, использующих AJAX отправку применим следующий код

```javascript
$("form").submit(function(event){

  event.preventDefault(); // Блокируем перезагрузку страницы  
  
  // Далее идут обработчики:
  
  // - Валидация полей формы 
  // - Отправка формы (AJAX) 
  // - Обработка ответа от сервера (успешная отправка или ошибка)
  // - Другой полезный код (например, запрет на повторную отправку формы) 
  
});  
```

__События клавиатуры__

```javascript
////////////////////////////////////////////////////////////
// .keydown()  - Клавиша нажата (самый часто используемый метод!) 
// .keyup()    - Нажатая клавиша была отпущена 
// .keypress() - Нажатие клавиш, кроме специальных - не рекомендуется использовать! 
//               (также различная поддержка в разных браузерах)
////////////////////////////////////////////////////////////

// Отследим нажатие клавиш на текстовом поле 

$('input[type="text"]').keydown(function(e){

  console.log("KeyCode: ", e.keyCode); // Код клавиши 
  
  if (event.keyCode == 8 || event.keyCode == 46) {
    // Чего нибудь делаем! 
  }
  
}); 
```

Для сложных отслеживаний клавиш и сочетаний клавиш, можно использовать плагины, например __keymaster.js__

- https://github.com/madrobby/keymaster

__Браузерные события__

События для загрузки документа DOM и события для скроллинга рассматривали ранее

Рассмотрим метод __resize()__ - устанавливает обработчик для отслеживания изменения размеров окна браузера 

```javascript
$( window ).resize(function() {

	let width  = $( window ).width();
	let height = $( window ).height(); 
	
	// Далее может быть код, для построения верстки, зависящей от ширины окна бруазера 
		
});
```

### Универсальный метод .on()  

Вышеперечисленные методы для привязки обработчиков к событиям не работают для элементов страницы, которые создаются динамически.

Для привязки событий к динамически создаваемым элементам можно использовать метод __.on()__

Также метод __.on()__ позволяет добавлять пользовательские данные в обработчики событий

Общий вид синтаксиса метода __.on()__

```javascript
// Простой вариант 
$("Селектор").on("ИмяСобытия", ФункцияОбработчикСобытия); 

// Вариант с добавлением пользовательских данных 
$("Селектор").on("ИмяСобытия", ОбъектДанных ФункцияОбработчикСобытия); 

// Продвинутый вариант 
$("Селектор родитель").on("ИмяСобытия", "Дочерний селектор", ФункцияОбработчикСобытия); 

// Продвинутый вариант с добавлением пользовательких данных 
$("Селектор родитель").on("ИмяСобытия", "Дочерний селектор", ОбъектДанных, ФункцияОбработчикСобытия); 
```

Тут имя события в большинстве случаев совпадает с именами событий, рассмотренных выше.

__Примеры:__

```javascript
////////////////////////////////////////////////////////////
// Клик по элементу 
////////////////////////////////////////////////////////////

$(document).on("click", "p", function(){
  console.log("Клик по элементу");
});

////////////////////////////////////////////////////////////
// Клик по элементу (Добавим свои данные в обработчик события) 
////////////////////////////////////////////////////////////

// Пользовательские данные становятся доступными в объекте event.data
let myData = {userText: "Привет от Васи"};  

$(document).on("click", "h1", myData, function(event){ 
  let $element = $(this); 
  let userText = event.data.userText; 
  $element.text(userText); // Заменили текст заголовка 
});  

////////////////////////////////////////////////////////////
// Событие "change" 
////////////////////////////////////////////////////////////

$(document).on("change", "select", function(event){ 
  let value =  $(this).val(); 
  console.log(value); 
});  

```

### Блокировка стандартных событий: event.preventDefault()

__javascript позволяет блокировать стандартные действия браузера для элементов во время наступления событий внутри перехватчиков этих событий.__

__event.preventDefault()__ - Метод для блокировки стандарных действий (event - объект события) 

Примеры использования: 

```javascript
////////////////////////////////////////////////////////////
// Блокируем переход по ссылкам 
////////////////////////////////////////////////////////////

$(document).on("click", "a.blockedLink", function(event){
  event.preventDefault(); 
  
  // Переход по ссылке заблокирован, можем получить адрес ссылки
  let href = $(this).attr("href"); 
  console.log("href: ", href); 
  
});

////////////////////////////////////////////////////////////
// Блокировка отправки формы 
////////////////////////////////////////////////////////////

$(document).on("click", "form.ajax_form", function(event){
  event.preventDefault(); 
  
  // Функционал ajax отправки 
});

////////////////////////////////////////////////////////////
// Ограничение введения определенных символов в тексте 
////////////////////////////////////////////////////////////

// Код на чистом JS

var myTextbox = document.getElementById('my-textbox');
myTextbox.addEventListener( 'keypress', checkName, false );

function checkName(evt) {
    var charCode = evt.charCode;
    if (charCode != 0) {
        if (charCode < 97 || charCode > 122) {
            evt.preventDefault();
            alert(
                "Пожалуйста, используйте только буквы нижнего регистра на латинице"
                + "\n" + "charCode: " + charCode + "\n"
            );
        }
    }
}

```

### Блокировка распространения события: event.stopPropagation() 


### Триггеры событий в jQuery

__Ссылки:__

- https://api.jquery.com/category/events/
- https://www.tutorialsteacher.com/jquery/jquery-event-reference
- https://www.tutorialsteacher.com/jquery/jquery-event
- https://basicweb.ru/jquery/jquery_event_on.php
- https://api.jquery.com/on/
- https://basicweb.ru/jquery/jquery_events.php
- https://stackoverflow.com/questions/7858979/difference-between-focusin-focusout-and-focus-blur-with-example
- https://learn.javascript.ru/bubbling-and-capturing
- https://stackoverflow.com/questions/3350247/how-to-prevent-form-from-being-submitted 
- https://developer.mozilla.org/ru/docs/Web/API/Event/preventDefault
- https://github.com/madrobby/keymaster

