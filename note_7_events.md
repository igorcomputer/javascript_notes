## Javascript - Введение в браузерные события

Событие – это сигнал от браузера о том, что что-то произошло. Все DOM-узлы подают такие сигналы (хотя события бывают и не только в DOM).

### Примеры основных типов событий (реально их намного больше) 

__События мыши:__

- click – происходит, когда кликнули на элемент левой кнопкой мыши (на устройствах с сенсорными экранами оно происходит при касании).
- contextmenu – происходит, когда кликнули на элемент правой кнопкой мыши.
- mouseover / mouseout – когда мышь наводится на / покидает элемент.
- mousedown / mouseup – когда нажали / отжали кнопку мыши на элементе.
- mousemove – при движении мыши.

__События на элементах управления:__

- submit – пользователь отправил форму <form>.
- focus – пользователь фокусируется на элементе, например нажимает на <input>.

__Клавиатурные события:__

- keydown и keyup – когда пользователь нажимает / отпускает клавишу.

__События документа:__

- DOMContentLoaded – когда HTML загружен и обработан, DOM документа полностью построен и доступен.

__CSS events:__

- transitionend – когда CSS-анимация завершена.


__Обработчики событий - это функции, или методы, которые выполняются при наступлении события__

Обработчик cобытия также называют __слушателем события__ (такой термин часто встречается в документации)

Обычно для привязки функций к событиям используют подобные выражения: 

- повесить обработчик на событие, 
- назначить событию обработчик, 
- привязать обработчик к событию


### Способы привязки обработчиков к событиям

__Использование атрибута HTML__

Кавычки важны (либо одинарные внутри двойных, либо наоборот) 

```javascript

//////////////////////////////////////////////////////
// Использование кода внутри onlclick 
//////////////////////////////////////////////////////

<input value="Нажми меня" onclick="alert('Клик!')" type="button">

//////////////////////////////////////////////////////
// Использование внешней функции
//////////////////////////////////////////////////////

<script>
  function countRabbits() {
    for(let i=1; i<=3; i++) {
      alert("Кролик номер " + i);
    }
  }
</script>

<input type="button" onclick="countRabbits()" value="Считать кроликов!">

//////////////////////////////////////////////////////
// Использование свойства DOM-объекта (предпочтительный вариант) 
//////////////////////////////////////////////////////

<input id="elem" type="button" value="Нажми меня!">

<script>
  elem.onclick = function() {
    alert('Спасибо');
  };
</script>

//////////////////////////////////////////////////////
// Аналогично, с вынесением обработчика в отдельную функцию 
//////////////////////////////////////////////////////

<input id="elem" type="button" value="Нажми меня!">

<script>
function sayThanks() {
  alert('Спасибо!');
}
elem.onclick = sayThanks;
<script>

//////////////////////////////////////////////////////
// Одновременное использьзование НЕ ДОПУСКАЕТСЯ! 
// (будет перезапись вторым обработчиком)
//////////////////////////////////////////////////////

<input type="button" id="elem" onclick="alert('Было')" value="Нажми меня">

<script>
  elem.onclick = function() { // перезапишет существующий обработчик
    alert('Станет'); // выведется только это
  };
</script>  


//////////////////////////////////////////////////////
// Доступ через this
//////////////////////////////////////////////////////

<button onclick="alert(this.innerHTML)">Нажми меня</button>

```

__Недостатки:__ 

Нельзя повесить несколько обработчиков на одно событие. 
Если так сделать, обработчики перезапишут друг друга! 

### Метод addEventListener

__Позволяет повесить несколько обработчиков на одно событие__

Базовый синтаксис: 

```javascript
element.addEventListener(event, handler[, options]);
```

Описание аргументов: 

- event - Имя события, например "click".
- handler - Ссылка на функцию-обработчик.
- options - Дополнительный объект со свойствами (подробности - см. ссылки внизу) 

__Пример добавления нескольких обработчиков на одно событие__

```javascript
<input id="elem" type="button" value="Нажми меня"/>

<script>
function handler1() { alert('Спасибо!'); };
function handler2() { alert('Спасибо ещё раз!'); }

elem.onclick = () => alert("Привет");
elem.addEventListener("click", handler1); // Спасибо!
elem.addEventListener("click", handler2); // Спасибо ещё раз! 
</script>
```

__Существуют события, которые нельзя назначить через DOM-свойство, но можно через addEventListener__

```javascript
//////////////////////////////////////////
// Привязка к событию через свойство
//////////////////////////////////////////

document.onDOMContentLoaded = function() {
  alert("DOM построен"); // не будет работать
};

//////////////////////////////////////////
// Привязка к событию через свойство
//////////////////////////////////////////

document.addEventListener("DOMContentLoaded", function() {
  alert("DOM построен"); // а вот так сработает
});

```

### Объект события

__- Обеспечивает доступ к деталям события в момент наступленя события__

Данный объект имеет свойства, которые могут быть считаны при наступлении события: 

Примеры некоторых свойств __для события "click"__ (свойств много, приведены лишь некоторые)

- __event.type__ - Тип события, в данном случае "click".

- __event.currentTarget__ - Элемент, на котором сработал обработчик. 

- __event.clientX / event.clientY__ - Координаты курсора (например для click) 

```javascript
<input type="button" value="Нажми меня" id="elem">

<script>
  elem.onclick = function(event) {
    // вывести тип события, элемент и координаты клика
    alert(event.type + " на " + event.currentTarget);
    alert("Координаты: " + event.clientX + ":" + event.clientY);
  };
</script>

// Доступность объекта события в HTML также работает!
<input type="button" onclick="alert(event.type)" value="Тип события">

```

### Объект-обработчик: handleEvent

Метод addEventListener может назначить не только функцию, для события но и объект, у которого есть специальный метод, 
выполняющийся при наступления события.

```javascript
///////////////////////////////////////////////////////
// Пример с функцией 
//////////////////////////////////////////////////////

<button id="elem">Нажми меня</button>

<script>
  elem.addEventListener('click', {
    handleEvent(event) {
      alert(event.type + " на " + event.currentTarget);
    }
  });
</script>

///////////////////////////////////////////////////////
// Пример с объектом handleEvent
//////////////////////////////////////////////////////

<button id="elem">Нажми меня</button>

<script>
var objEvent = {
  handleEvent(event) {
    alert(event.type + " на " + event.currentTarget);
  }
}; 

elem.addEventListener('click', objEvent);
</script>

///////////////////////////////////////////////////////
// Пример с использованием класса и объекта handleEvent
///////////////////////////////////////////////////////

<button id="elem">Нажми меня</button>

<script>
class Menu {
 handleEvent(event) {
   switch(event.type) {
	case 'mousedown':
	  elem.innerHTML = "Нажата кнопка мыши";
	  break;
	case 'mouseup':
	  elem.innerHTML += "...и отжата.";
	  break;
   }
 }
}

let menu = new Menu();
elem.addEventListener('mousedown', menu);
elem.addEventListener('mouseup', menu);
</script>
```

__Ссылки__:

- https://learn.javascript.ru/introduction-browser-events
- https://learn.javascript.ru/bubbling-and-capturing
- https://learn.javascript.ru/event-delegation 
- https://learn.javascript.ru/default-browser-action
- https://learn.javascript.ru/dispatch-events
- https://learn.javascript.ru/event-details
- https://learn.javascript.ru/forms-controls





